more use of malloc and free
